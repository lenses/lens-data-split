<!doctype html>
<html>
<head>
  <title>core-data-split</title>

  <script src="../../webcomponentsjs/webcomponents.js"></script>
  <script src="../../web-component-tester/browser.js"></script>

  <link rel="import" href="../th-data-split.html">

</head>
<body>

  <th-data-split id="data-split"></th-data-split>

  <script>
    var should = chai.should();
    var dataSplit = document.querySelector("#data-split");

    // the event listener callback will be added / removed in every async test
    var callback = function() {};

    // some input data
    var input = new Object([{"label":"Marshawn Lynch, RB"},{"label":"Dez Bryant, WR"},{"label":"Jamaal Charles, RB"},{"label":"Antonio Brown, WR"},{"label":"Jordy Nelson, WR"},{"label":"Arian Foster, RB"},{"label":"DeMarco Murray, RB"},{"label":"Eddie Lacy, RB"},{"label":"Antonio Gates, TE"},{"label":"Rob Gronkowski, TE"}]);

    // testing suite
    suite("<th-data-split>", function() {

      test("component can be created as an object", function(done) {
        should.exist(dataSplit);
        done();
      });

      test("accepts input", function(done) {

        // set the event listener callback
        dataSplit.removeEventListener("th-output-ready", callback);
        callback = function(e) {
          dataSplit.input.should.equal(input);
          console.log("cb2");
        };
        dataSplit.addEventListener("th-output-ready", callback);

        // change input
        dataSplit.input = input;

        // check th-output-ready event
        asyncPlatformFlush(function() {
          done();
        });
      });


      test("assign a splitCol and output the result", function(done) {
        var splitCol = "label";

        dataSplit.removeEventListener("th-output-ready", callback);
        callback = function(e) {
          dataSplit.splitCol.should.equal(splitCol);
          var player = dataSplit.output[0].split1;
          var pos = dataSplit.output[0].split2;
          console.log(player);
          player.should.equal("Marshawn Lynch");
          pos.should.equal("RB");
        };
        dataSplit.addEventListener("th-output-ready", callback);


        // change splitCol
        dataSplit.splitCol = splitCol;

        // check th-output-ready event
        asyncPlatformFlush(function() {
          done();
        });
      });

      test("change splitColNames", function(done) {
        var splitColNames = ["Player", "Position"];

        dataSplit.removeEventListener("th-output-ready", callback);
        callback = function(e) {
          var newColNames = Object.keys(dataSplit.output[0]);
          console.log(newColNames);
          newColNames[1].should.equal(splitColNames[0]);
          newColNames[2].should.equal(splitColNames[1]);
        };
        dataSplit.addEventListener("th-output-ready", callback);

        // change splitCol
        dataSplit.splitColNames = splitColNames;

        // check th-output-ready event
        asyncPlatformFlush(function() {
          done();
        });
      });

      test("assign splitCol", function(done) {
        var splitColNames = ["Player", "Position"];

        dataSplit.removeEventListener("th-output-ready", callback);
        callback =function(e) {
          var newColNames = Object.keys(dataSplit.output[0]);
          newColNames[1].should.equal(splitColNames[0]);
          newColNames[2].should.equal(splitColNames[1]);
        };
        dataSplit.addEventListener("th-output-ready", callback);

        // change splitCol
        dataSplit.splitColNames = splitColNames;

        // check th-output-ready event
        asyncPlatformFlush(function() {
          done();
        });
      });


    });
  </script>

</body>
</html>
